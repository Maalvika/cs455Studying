# Lecture 8: Thread Safety
## Thread Safety
#### Terms:
- **Wait()** - a command used to tell a thread to wait for an object lock.
- **Notify()** - a command used to tell a thread that the lock if freed.
  
#### Concepts:
- Wait-notify on its own race condition.
  - Ex. The first thread _tests the condition_
  - The second thread _sets the condition_
  - The second thread calls notify() which goes _unheard_.
  - The first thread calls wait()
- How does this race condition get solved?
  - Whenever calling wait() or notify() you must obtain the lock for the object.
- When holding a lock for an object when using wait():
  - wait() releases lock pritor to waiting.
  - It then Reacquires the lock just before returning from wait().
- Wait() is _tightly integreated_ with the lock mechanism.
  - The object lock is _not freed until_ the waiting thread is in a _state in which it can receive notifications_.
  - This prevents race conditions from occuring here.
- When a thread receives a notification it is _not_ garunteed that the condition is set.
  - _Prior_ to calling wait() you should _retest_ the condition to see if you should wait() again.
- Wait-and-notify mechanisms have no knowledge about the condition which it notifies.
  - If notify() is called when no other thread is waiting, _the notification is lost_.
- When more than one thread is waiting for a notification:
  - The language does not specify which thread will get the notification first.
    - This is based on the JVM implementation, sheculing and timing issues.
  - _There is no way to determine_ which thread will get he notification.
- NotifyAll():
  - All threads that are waiting on an object will be notified.
  - When threads are notified, they must work out which thread should continue.
  - And figure out which threads should call wait agin.
    - All threads wake up, but they _thill have to reacquire the object lock_.
- Threads and Locks:
  - _Locks are helld by threads_.
    - A thread can hold multiple locks.
  - If a lock is held by some other thread:
    - The thread _must wait_ for it to be free: _There is no preemption of locks!_.
    - If the lock is unavailable, it blocks all the waiting threads.
    
## Thread Safety
#### Terms:
- **key term** - ...
- ...

#### Concepts:
- Racing and synchronization:
  - Synchronization is used to _prevent race conditions_.
  
