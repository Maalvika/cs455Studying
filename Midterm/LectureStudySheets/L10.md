# Lecture 10: Thread Safety
## Vehicle Tracker Application
#### Terms:

#### Concepts:
- We will be looking at a case study involving a vehicle tracker application in this subtopic
  - We will assume the following:
    - Each vehcile is identified by a string
    - The location of a vehcile is represented by (x,y) cooordinates
    - We have a VehcileTracker class that holds this information
- We will have two threads, a viewer and updater

![alt-text](https://raw.github.com/jarretflack/cs455Studying/master/Midterm/images/L10-viewer-updater-threads.png?raw=true)

- Our VehicleTracker class

![alt-text](https://raw.github.com/jarretflack/cs455Studying/master/Midterm/images/L10-vehicle-tracker-class.png?raw=true)

- Our MutablePoint class

![alt-text](https://raw.github.com/jarretflack/cs455Studying/master/Midterm/images/L10-mutable-point-class.png?raw=true)

- It is important to note that even though our MutablePoint class is not thread-safe, our VehicleTracker class still is
- The following illustrates a deep copy

![alt-text](https://raw.github.com/jarretflack/cs455Studying/master/Midterm/images/L10-deep-copy.png?raw=true)

- Delegating thread-safety

![alt-text](https://raw.github.com/jarretflack/cs455Studying/master/Midterm/images/L10-delegating-thread-safety.png?raw=true)

- An immutable point

![alt-text](https://raw.github.com/jarretflack/cs455Studying/master/Midterm/images/L10-immutable-point.png?raw=true)

- When delegation fails

![alt-text](https://raw.github.com/jarretflack/cs455Studying/master/Midterm/images/L10-delegation-fails.png?raw=true)

## Adding Functionality To Existing Thread-Safe Classes
#### Terms:

**None**

#### Concepts:
- Often times we have thread-safe classes that support almost all of the operations we need, so the goal is that we want to add a new operation to the thread-safe class without undermining its thread-safety
- The safest way to add additional operations thread-safe class is the following:
  - Extend the class
  - Place the extension code in a helper class
  - Composition (combine thread-safe elements)
- The following illustrates extending Vector to have a put-if-absent method

![alt-text](https://raw.github.com/jarretflack/cs455Studying/master/Midterm/images/L10-put-if-absent-vector.png?raw=true)

- Sometimes extending a class or adding a method is not possible
  - An example would be if an ArrayList is wrapped with a Collections.SynchronizedList wrapper, in this case the client code does not even know the class of the List object within
  - In these situations we will use a helper class
  
- Bad example:
![alt-text](https://raw.github.com/jarretflack/cs455Studying/master/Midterm/images/L10-client-side-locking-bad.png?raw=true)

- Good example:
![alt-text](https://raw.github.com/jarretflack/cs455Studying/master/Midterm/images/L10-client-side-locking-good.png?raw=true)

- Contrasting extending a class and client side locking
  - Extending a class to add an atomic operation?
    - This distributes locking code over multiple classes in the object hierarchy
  - Client side locking is even more fragile
    - We place locking code for a Class C in classes that are completely unrelated to it
- Composition is a less fragile alternative to adding an atomic operation, the following illustrates this

![alt-text](https://raw.github.com/jarretflack/cs455Studying/master/Midterm/images/L10-composition.png?raw=true)

- A couple notes about ImprovedList from the example above:
  - No need to worry if the extended List class is not thread-safe, it turns out that ImprovedList uses its own intrinsic lock
  - This extra layer of syncrhonization may add a small performance penalty, but this is negilable

## Synchronized Collections
#### Terms:

#### Concepts:

## Concurrent Collections
#### Terms:

#### Concepts:

## Synchronizers
#### Terms:

#### Concepts:
