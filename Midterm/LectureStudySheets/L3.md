# Lecture 3

## Encapsulation
#### Terms:
- **header** - small data structure attached to the message by lower level layers (few bytes to several dozen bytes)
- **trailer** - control info at the end of message
- **payload** - data being transmitted (also: body)
- **demux key** - info included in the header on how to demultiplex data
  - 8-bit field, can be single demux field or pair of demux fields
#### Concepts:
- Format is specific to the protocol, data is said to be encapsulated
![Encapsulation](https://raw.github.com/jarretflack/cs455Studying/master/Midterm/images/L3-encapsulation.png?raw=true)
- Low-level protocol doesn't interpret message, only compresses or encrypts data

## OSI Network Architecture
#### Terms:
- **layers**
  - *physical layer* - handles tansmission of raw bits (bits)
  - *data link layer* - collects bits into a frame, computes checksum for frame (frames)
  - *network layer* - handles routing amoung nodes in a packet-switched network (packets)
  - *transport layer* - implements process-process channel (messages)
  - *presentation layer* - format of data exchanged between peers (format)
  - *session layer* - namespace to tie different transport-streams that are part of the application (namespace)
#### Concepts:
- Partitions network functionality into 7 layers
- Each layer its own header and trailer

## Internet Architecture
#### Terms:
- **process-per-protocol** - each protocol in separate process
  - context-switch required at each level
- **process-per-message** - treat each protocol as a static piece of code
  - procedure call required at every level
#### Concepts:
- Does not imply strict layering: bypassing lowel layers is possible
- Layer has an hourglass shape: IP is the focal point
![Internet Architecture](https://raw.github.com/jarretflack/cs455Studying/master/Midterm/images/L3-internetarch.png?raw=true)

## Internetworking
#### Terms:
- **internetwork** - arbitrary collection of interconnected hosts to provide some sort of host-host packet delivery system
  - "network of networks"
- **internet protocol (IP)** - key to build scalable, heterogeneous networks; runs on all nodes (hosts and routers)
  - datagram model of delivery (connectionless, best-effort)
  - *addressing scheme* - identifies all hosts in the internetwork
  - one of its original goals is to keep routers simple
- **datagram** - a type of packet sent in a connectionless fashion and without a need for advance setup mechanisms
- **maximum transmission unit (MTU)** - largest IP datagram the network can carry in its frame
  - smaller than the largest packet-size of network (Ethernet v2: 1500 bytes, FDDI: 4500 bytes)
  - fragmentation necessary when packet is larger than MTU
#### IPv4:
- represented as a succession of 32-bit words
- top word transmitted first, leftmost byte transmitted first
![IPv4 Packet](https://raw.github.com/jarretflack/cs455Studying/master/Midterm/images/L3-ipv4.png?raw=true)
- **Version** - allows for redefining packet later on
- **HLen** - length of header in 32-bit words (5 words/20 bytes most of the time)
- **TOS** - terms of service (not widely implented)
  - used as - `7,6,5`: precendence bits, `4`: low delay, `3`: high throughput, `2`: high reliability, `1,0`: unused
- **Length** - length of datagram in bytes
- **Ident,Flags,Offset** - information about fragmentation
- **TTL** - time to live, used as hop count
- **Protocol** - demultiplexing key
- **Checksum** - correctness verification
- **SourceAddr/DestAddr** - source/destination address
- **Options** - presence or absence defined by size of HLen
#### Fragmentation:
- All fragments carry same identifier in Ident field
- If not all fragments arrive at receiving host, receiver gives up reassembly after timeout (~15 sec) and discards packets that did arrive
- IP does not attempt to recover from missing packets
- fragmentation occurrs at 8-byte boundaries


![Fragmented IPv4 Packet](https://raw.github.com/jarretflack/cs455Studying/master/Midterm/images/L3-ipv4frag.png?raw=true)

