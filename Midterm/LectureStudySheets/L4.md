# Lecture 4

## IPv6 
#### Key Differences with IPv4:
- source/destination addresses are 128-bits
- IPv6 treats Options as extension headers
- no fragmentation to simplify processing of packets
- no checksum
#### Packet Structure:
![IPv6 Packet header](https://raw.github.com/jarretflack/cs455Studying/master/Midterm/images/L4-ipv6.png?raw=true)
- **Version** - 4 bits: 0110
- **Traffic Class** - 8 bits: differentiated services for QoS, anything ending in `11` is intended for experimental/local use
- **Flow Label** - 20 bits: if non-zero, tells routers/switches to route packets on the same outbound path
- **Payload Length** - 16 bits: size of payload including extension headers
- **Next header** - 8 bits: specifies type of next header
- **Hop limit** - 8 bits: replaces time-to-live field of IPv4
- **SourceAddr/DestAddr** - 128 bits: source/destination address


![IPv6 Packet Structure](https://raw.github.com/jarretflack/cs455Studying/master/Midterm/images/L4-ipv6struct.png?raw=true)

## UDP (User Datagram Protocol)
#### Terms:
- **port** - abstract locator, typically implemented as a message queue. If the queue is full, message is discarded.
#### Concepts:
- simplest possible transport protocol: extends host-to-host into process-to-process communications
- no additional functionality to best-effort service
- adds demultiplexing
#### Packet Structure:


![UDP Header](https://raw.github.com/jarretflack/cs455Studying/master/Midterm/images/L4-udp.png?raw=true)

## TCP (Transmission Control Protocol)
#### Terms:
- **acknowledgement (ACK)** - confirmation of receipt of data
- **timeout** - retransmit if ACK not received within a specified time
- **automatic repeat request (ARQ)** - use of ACKs and timeouts for reliable delivery
- **stop-and-wait** - after transmitting one frame, sender waits for ACK before transmitting next frame
  - if the ACK doesn't arrive after a period of time, sender retransmits original frame
- **full-duplex** - each connection supports a pair of byte streams
- **flow control** - allows receiver to limit the data sender (end-to-end issue)
- **congestion control** - throttle how fast TCP sends data, keep sender from overloading network (hosts & networks interact)
#### Concepts:
- **setup** - two sides of the connection agree to exchange data, establish shared state (SYN, SYN-ACK, ACK)
- **teardown** - let host know it is ok to free the shared state (FIN, ACK, FIN, ACK)
- TCP accepts data from stream, breaks it into chunks, and adds a TCP header, creating a TCP segment.
#### Header Format:
![TCP Header](https://raw.github.com/jarretflack/cs455Studying/master/Midterm/images/L4-tcp.png?raw=true)
#### Sliding Window:
- guarantees reliable delivery of data, enforces flow control between sender and receiver
- `AdvertisedWindow = MaxRcvBuffer - ((NextByteExpected-1) - LastByteRead)`
  - if the process is reading data as fast as it arrives, `AdvertisedWindow` stays open.
  - if receiving process falls behind, `AdvertisedWindow` shrinks
- TCP adheres to the receiver's advertised window
  - `EffectiveWindow = AdvertisedWindow - (LastByteSent - LastByteAcked)`
